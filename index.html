<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Borderô - Feijoada do Nosso Tom</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 1000px;
      margin: auto;
      background-color: white;
      color: black;
    }
    h1, h2, h3 {
      color: black;
    }
    input, textarea, select, button {
      margin: 5px 0;
      padding: 8px;
      width: 100%;
      box-sizing: border-box;
    }
    .section {
      margin-bottom: 30px;
    }
    .btn {
      background-color: #333;
      color: white;
      border: none;
      cursor: pointer;
    }
    .btn:hover {
      opacity: 0.9;
    }
    ul {
      padding-left: 20px;
    }
    ul li {
      color: black;
      margin-bottom: 5px;
    }
    .delete-btn {
      background-color: red;
      color: white;
      border: none;
      padding: 2px 6px;
      margin-left: 10px;
      cursor: pointer;
    }
    .total {
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Controle de Borderô - Feijoada do Nosso Tom</h1>

  <!-- Ingressos -->
  <div class="section">
    <h2>Ingressos Vendidos Antecipados</h2>
    <input id="setorInput" placeholder="Setor (Ex: Pista, Camarote)" onkeydown="if(event.key==='Enter') adicionarIngresso()">
    <input type="number" id="qtdIngressoInput" placeholder="Quantidade" onkeydown="if(event.key==='Enter') adicionarIngresso()">
    <button class="btn" onclick="adicionarIngresso()">Adicionar</button>
    <ul id="listaIngressos"></ul>
    <div class="total">Total: <span id="totalIngressos">0</span></div>
  </div>

  <!-- Liberação Nabera -->
  <div class="section">
    <h2>Liberações Nabêra</h2>
    <input id="nomeNabera" placeholder="Nome" onkeydown="if(event.key==='Enter') adicionarNabera()">
    <input type="number" id="qtdNabera" placeholder="Quantidade" onkeydown="if(event.key==='Enter') adicionarNabera()">
    <button class="btn" onclick="adicionarNabera()">Adicionar</button>
    <ul id="listaNabera"></ul>
  </div>

  <!-- Liberação Nosso Tom -->
  <div class="section">
    <h2>Liberações Nosso Tom</h2>
    <input id="nomeNossoTom" placeholder="Nome" onkeydown="if(event.key==='Enter') adicionarNossoTom()">
    <input type="number" id="qtdNossoTom" placeholder="Quantidade" onkeydown="if(event.key==='Enter') adicionarNossoTom()">
    <button class="btn" onclick="adicionarNossoTom()">Adicionar</button>
    <ul id="listaNossoTom"></ul>
  </div>

  <!-- Abadás disponíveis -->
  <div class="section">
    <h2>Abadás Disponíveis</h2>
    <input type="number" id="abadasDisponiveis" placeholder="Quantidade" onkeydown="if(event.key==='Enter') adicionarDisponivel()">
    <button class="btn" onclick="adicionarDisponivel()">Adicionar</button>
    <ul id="listaDisponiveis"></ul>
  </div>

  <!-- Abadás entregues -->
  <div class="section">
    <h2>Abadás Entregues</h2>
    <input type="number" id="abadasEntregues" placeholder="Quantidade" onkeydown="if(event.key==='Enter') adicionarEntregue()">
    <button class="btn" onclick="adicionarEntregue()">Adicionar</button>
    <ul id="listaEntregues"></ul>
  </div>

  <!-- Observações -->
  <div class="section">
    <h2>Observações</h2>
    <textarea id="obsInput" placeholder="Digite uma observação" onkeydown="if(event.key==='Enter') adicionarObs()"></textarea>
    <button class="btn" onclick="adicionarObs()">Adicionar</button>
    <ul id="listaObs"></ul>
  </div>

  <div class="section">
    <button class="btn" onclick="gerarBorderoNaTela()">Ver Borderô na Tela</button>
    <button class="btn" onclick="exportarPDF()">Exportar Borderô em PDF</button>
  </div>

<script>
  let totalIngressos = 0;
  function adicionarItem(listaId, texto, qtd = 0, totalId = null) {
    const ul = document.getElementById(listaId);
    const li = document.createElement("li");
    li.innerHTML = `${texto} <button class="delete-btn" onclick="this.parentElement.remove(); atualizarTotal('${listaId}', '${totalId}')">Excluir</button>`;
    li.dataset.qtd = qtd;
    ul.appendChild(li);
    if (totalId) atualizarTotal(listaId, totalId);
  }

  function atualizarTotal(listaId, totalId) {
    const lista = document.getElementById(listaId);
    let total = 0;
    for (let item of lista.children) {
      total += parseInt(item.dataset.qtd || 0);
    }
    document.getElementById(totalId).innerText = total;
  }

  function adicionarIngresso() {
    const setor = document.getElementById("setorInput").value;
    const qtd = parseInt(document.getElementById("qtdIngressoInput").value);
    if (setor && qtd) {
      adicionarItem("listaIngressos", `${setor}: ${qtd} ingresso(s)`, qtd, "totalIngressos");
      document.getElementById("setorInput").value = "";
      document.getElementById("qtdIngressoInput").value = "";
    }
  }

  function adicionarNabera() {
    const nome = document.getElementById("nomeNabera").value;
    const qtd = document.getElementById("qtdNabera").value;
    if (nome && qtd) {
      adicionarItem("listaNabera", `${nome}: ${qtd} liberação(ões)`);
      document.getElementById("nomeNabera").value = "";
      document.getElementById("qtdNabera").value = "";
    }
  }

  function adicionarNossoTom() {
    const nome = document.getElementById("nomeNossoTom").value;
    const qtd = document.getElementById("qtdNossoTom").value;
    if (nome && qtd) {
      adicionarItem("listaNossoTom", `${nome}: ${qtd} liberação(ões)`);
      document.getElementById("nomeNossoTom").value = "";
      document.getElementById("qtdNossoTom").value = "";
    }
  }

  function adicionarDisponivel() {
    const qtd = document.getElementById("abadasDisponiveis").value;
    if (qtd) {
      adicionarItem("listaDisponiveis", `${qtd} abadás disponíveis`);
      document.getElementById("abadasDisponiveis").value = "";
    }
  }

  function adicionarEntregue() {
    const qtd = document.getElementById("abadasEntregues").value;
    if (qtd) {
      adicionarItem("listaEntregues", `${qtd} abadás entregues`);
      document.getElementById("abadasEntregues").value = "";
    }
  }

  function adicionarObs() {
    const obs = document.getElementById("obsInput").value;
    if (obs) {
      adicionarItem("listaObs", obs);
      document.getElementById("obsInput").value = "";
    }
  }

  function gerarBorderoNaTela() {
    const borderoWindow = window.open('', '_blank');
    borderoWindow.document.write('<html><head><title>Borderô</title></head><body>');
    borderoWindow.document.write('<h1>Borderô - Feijoada do Nosso Tom</h1>');
    const sections = ['Ingressos', 'Nabera', 'NossoTom', 'Disponiveis', 'Entregues', 'Obs'];
    sections.forEach(id => {
      const lista = document.getElementById(`lista${id}`);
      if (lista.children.length > 0) {
        borderoWindow.document.write(`<h2>${lista.previousElementSibling.innerText}</h2><ul>`);
        for (let item of lista.children) {
          borderoWindow.document.write(`<li>${item.innerText.replace('Excluir','')}</li>`);
        }
        borderoWindow.document.write('</ul>');
      }
    });
    borderoWindow.document.write('</body></html>');
    borderoWindow.document.close();
  }

  async function exportarPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    let y = 10;
    doc.setFontSize(16);
    doc.text("Borderô - Feijoada do Nosso Tom", 10, y);
    y += 10;

    const sections = [
      { id: 'listaIngressos', title: 'Ingressos Vendidos Antecipados' },
      { id: 'listaNabera', title: 'Liberações Nabêra' },
      { id: 'listaNossoTom', title: 'Liberações Nosso Tom' },
      { id: 'listaDisponiveis', title: 'Abadás Disponíveis' },
      { id: 'listaEntregues', title: 'Abadás Entregues' },
      { id: 'listaObs', title: 'Observações' }
    ];

    for (const sec of sections) {
      const lista = document.getElementById(sec.id);
      if (lista.children.length > 0) {
        doc.setFontSize(14);
        doc.text(sec.title, 10, y);
        y += 8;
        doc.setFontSize(12);
        for (let item of lista.children) {
          const text = item.innerText.replace('Excluir', '').trim();
          const lines = doc.splitTextToSize(text, 180);
          for (const line of lines) {
            if (y > 280) {
              doc.addPage();
              y = 10;
            }
            doc.text(line, 10, y);
            y += 6;
          }
        }
        y += 6;
      }
    }

    doc.save("bordero-nosso-tom.pdf");
  }
</script>
</body>
</html>
